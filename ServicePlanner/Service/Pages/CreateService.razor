@page "/create-service"

@using ServicePlanner.Service.Wizard.General
@using ServicePlanner.Service.Wizard.OrderOfService

@inject IJSRuntime Js
@inject PdfService PdfService
@inject IStringLocalizer<Strings> Localize

<Wizard OnFinish="HandleServiceCreation">
    <WizardStep Name="@Localize["ServiceWizard.Step.General.Title"]">
        <GeneralEditor Service="Service" />
    </WizardStep>
    <WizardStep Name="@Localize["ServiceWizard.Step.OrderOfService.Title"]">
        <OrderOfServiceEditor Service="Service"/>
    </WizardStep>
</Wizard>

@code {
    private Data.Service.Service Service { get; } = new() {Date = DateTime.Today };

    private void HandleServiceCreation()
    {
        var pdfData = PdfService.GenerateServicePdf(Service);
        DownloadFile(pdfData);
    }

    private void DownloadFile(byte[] pdfData)
    {
        FileUtility.SaveAs(Js, "Service.pdf", pdfData);
    }
}
